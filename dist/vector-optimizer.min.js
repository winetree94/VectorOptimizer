/*! For license information please see vector-optimizer.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.VectorOptimizer=e():t.VectorOptimizer=e()}(self,(function(){return function(){"use strict";var t={541:function(t,e,r){const n=r(655).__importStar(r(519));t.exports=n},519:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0});const n=r(655);n.__exportStar(r(564),e),n.__exportStar(r(664),e),n.__exportStar(r(269),e),n.__exportStar(r(738),e),n.__exportStar(r(80),e)},564:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.CubicBezier=void 0;const n=r(80);class o{constructor(t,e,r,n){this.p0=t,this.p1=e,this.p2=r,this.p3=n}static from(t){return new o(n.Vector.from(t.p0),n.Vector.from(t.p1),n.Vector.from(t.p2),n.Vector.from(t.p3))}sample(t){const e=1-t,r=e*e*e,n=3*e*e*t,o=3*e*t*t,i=t*t*t;return this.p0.multiply(r).add(this.p1.multiply(n)).add(this.p2.multiply(o)).add(this.p3.multiply(i))}}e.CubicBezier=o},664:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.CurveFitBase=void 0;const n=r(564),o=r(80);e.CurveFitBase=class{constructor(){this._u=[],this._squaredError=0}fitCurve(t,e,r,o,i,u){const s={response:!1,split:u,curve:i},a=this._pts,c=e-t+1;if(c<2)throw new Error("INTERNAL ERROR: Should always have at least 2 points here");if(2==c){const c=a[t],l=a[e],f=c.distance(l)/3,p=r.multiply(f).add(c),h=o.multiply(f).add(l);return i=new n.CubicBezier(c,p,h,l),s.curve=i,u=0,s.split=u,s.response=!0,s}u=0,s.split=u,this.arcLengthParamaterize(t,e),i=null,s.curve=i;for(let n=0;n<5;n++){0!=n&&this.reparameterize(t,e,i),i=this.generateBezier(t,e,r,o),s.curve=i;const u=this.findMaxSquaredError(t,e,i,s.split);if(s.split=u.split,u.response<this._squaredError)return s.response=!0,s}return s.response=!1,s}findMaxSquaredError(t,e,r=null,n=0){const o={response:0,split:n},i=this._pts,u=this._u;let s=(e-t+1)/2;const a=e-t+1;let c=0;for(let e=1;e<a;e++){const n=i[t+e],o=r.sample(u[e]),a=n.distanceSquared(o);a>c&&(c=a,s=e)}return(n=s+t)<=t&&(n=t+1),n>=e&&(n=e-1),o.split=n,o.response=c,o}generateBezier(t,e,r,o){const i=this._pts,u=this._u,s=e-t+1,a=i[t],c=i[e];let l=0,f=0,p=0,h=0,d=0;for(let e=1;e<s;e++){const n=u[e],s=1-n,y=s*s*s,m=3*s*s*n,_=3*s*n*n,b=n*n*n,v=a.multiply(y).add(a.multiply(m)).add(c.multiply(_)).add(c.multiply(b)),g=i[t+e].subtract(v),x=r.multiply(m),w=o.multiply(_);l+=x.dot(x),f+=x.dot(w),p+=w.dot(w),h+=x.dot(g),d+=w.dot(g)}const y=l*p-f*f,m=(h*p-d*f)/y,_=(l*d-f*h)/y,b=a.distance(c),v=Number.EPSILON*b;if(Math.abs(y)<Number.EPSILON||m<v||_<v){const t=b/3,e=r.multiply(t).add(a),i=o.multiply(t).add(c);return new n.CubicBezier(a,e,i,c)}{const t=r.multiply(m).add(a),e=o.multiply(_).add(c);return new n.CubicBezier(a,t,e,c)}}reparameterize(t,e,r){const n=this._pts,o=this._u,i=e-t;for(let e=1;e<i;e++){const i=n[t+e],u=o[e],s=1-u,a=r.p1.subtract(r.p0).multiply(3),c=r.p2.subtract(r.p1).multiply(3),l=r.p3.subtract(r.p2).multiply(3),f=c.subtract(a).multiply(2),p=l.subtract(c).multiply(2),h=r.sample(u),d=a.multiply(s*s).add(c.multiply(2*s*u)).add(l.multiply(u*u)),y=f.multiply(s).add(p.multiply(u)),m=(h.x-i.x)*d.x+(h.y-i.y)*d.y,_=d.x*d.x+d.y*d.y+(h.x-i.x)*y.x+(h.y-i.y)*y.y,b=u-m/_;Math.abs(_)>Number.EPSILON&&b>=0&&b<=1&&(o[e]=b)}}arcLengthParamaterize(t,e){const r=this._arclen,n=this._u;n.splice(0);const o=r[e]-r[t],i=r[t],u=e-t;n.push(0);for(let e=1;e<u;e++)n.push((r[t+e]-i)/o);n.push(1)}getLeftTangent(t){const e=this._pts,r=this._arclen,n=r[r.length-1],o=e[0];let i=e[1].subtract(o).normalize(),u=i,s=1;t=Math.min(8,t-1);for(let i=2;i<=t;i++){const t=1-r[i]/n,a=t*t*t,c=e[i].subtract(o).normalize();u=u.add(c.multiply(a)),s+=a}return u.length()>Number.EPSILON&&(i=u.divide(s).normalize()),i}getRightTangent(t){const e=this._pts,r=this._arclen,n=r[r.length-1],o=e[e.length-1];let i=e[e.length-2].subtract(o).normalize(),u=i,s=1;t=Math.max(e.length-9,t+1);for(let i=e.length-3;i>=t;i--){const t=r[i]/n,a=t*t*t,c=e[i].subtract(o).normalize();u=u.add(c.multiply(a)),s+=a}return u.length()>Number.EPSILON&&(i=u.divide(s).normalize()),i}getCenterTangent(t,e,r){const n=this._pts,i=this._arclen,u=i[r],s=n[r],a=i[t];let c=u-a,l=new o.Vector(0,0),f=0;for(let e=Math.max(t,r-4);e<r;e++){const t=(i[e]-a)/c,r=t*t*t,o=n[e].subtract(s).normalize();l=l.add(o.multiply(r)),f+=r}let p=l.length()>Number.EPSILON&&f>Number.EPSILON?l.divide(f).normalize():n[r-1].subtract(s).normalize();c=i[e]-u;const h=Math.min(e,r+4);l=new o.Vector(0,0),f=0;for(let t=r+1;t<=h;t++){const e=1-(i[t]-u)/c,r=e*e*e,o=s.subtract(n[t]).normalize();l=l.add(o.multiply(r)),f+=r}let d=l.length()>Number.EPSILON&&f>Number.EPSILON?l.divide(f).normalize():s.subtract(n[r+1]).normalize();return l=p.add(d),l.lengthSquared()<Number.EPSILON?(p=n[r-1].subtract(s).normalize(),d=s.subtract(n[r+1]).normalize(),l=p.add(d),l.lengthSquared()<Number.EPSILON?p:l.divide(2).normalize()):l.divide(2).normalize()}}},269:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0}),e.CurveFit=e.generateArcLengths=e.fit=void 0;const n=r(664),o=r(80),i=[];function u(t){const e=[];e.push(0);let r=0,n=t[0];for(let i=1;i<t.length;i++){const u=t[i];r+=o.Vector.from(n).distance(o.Vector.from(u)),e.push(r),n=u}return e}e.fit=function(t){return u(t),[]},e.generateArcLengths=u;class s extends n.CurveFitBase{constructor(t){super(),this._pts=t,this._result=[];const e=[];e.push(0);let r=0,n=this._pts[0];for(let t=1;t<this._pts.length;t++){const i=this._pts[t];r+=o.Vector.from(n).distance(o.Vector.from(i)),e.push(r),n=i}this._arclen=e}fit(t){if(t<Number.EPSILON)throw new Error("maxError cannot be negative/zero/less than epsilon value");if(!this._pts)throw new Error("points");if(this._pts.length<2)return i;this._squaredError=t*t;const e=this._pts.length-1,r=this.getLeftTangent(e),n=this.getRightTangent(0);return this.fitRecursive(0,e,r,n),this._result}fitRecursive(t=0,e=0,r,n){let i=0,u=null;const s=this.fitCurve(t,e,r,n,u,i);if(i=s.split,u=s.curve,s.response)this._result.push(u);else{const u=this.getCenterTangent(t,e,i),s=new o.Vector(-u.x,-u.y);0==t&&i<8&&(r=this.getLeftTangent(i)),e==this._pts.length-1&&i>this._pts.length-9&&(n=this.getRightTangent(i)),this.fitRecursive(t,i,r,u),this.fitRecursive(i,e,s,n)}}}e.CurveFit=s},738:function(t,e){function r(t){if(t.length<2)return t;let e=t[0];const r=t.length;let n=0;for(let o=1;o<r;o++){const r=t[o];e.equalsOrClose(r)?n++:e=r}if(0==n)return t;{const n=[];e=t[0],n.push(e);for(let o=1;o<r;o++){const r=t[o];e.equalsOrClose(r)||(n.push(r),e=r)}return n}}function n(t,e,r,i,u){if(i-r+1<3)return;const s=t[r],a=t[i],c=s.distance(a),l=s.x*a.y-a.x*s.y;let f=e,p=0;for(let e=r+1;e<i-1;e++){const r=o(s,a,c,l,t[e]);r>f&&(f=r,p=e)}0!=p&&(u.push(p),n(t,e,r,p,u),n(t,e,p,i,u))}function o(t,e,r,n,o){return Math.abs(n+e.x*o.y+o.x*t.y-o.x*e.y-t.x*o.y)/r}Object.defineProperty(e,"__esModule",{value:!0}),e.perpendicularDistance=e.rdpRecursive=e.rdpReduce=e.removeDuplicates=e.linearize=void 0,e.linearize=function(t,e,r=!1,n=!0){const o=[];if(null===t)throw new Error("Source vector array is null");if(e<=Number.EPSILON)throw new Error(`md ${e}' is be less than epsilon ${Number.EPSILON}`);if(t.length>0){let i=t[0];o.push(i);let u=0;for(let r=1;r<t.length;r++){const s=t[r-1],a=t[r],c=s.distance(a);if(u+c>e){const t=e-u;o.push(s.lerp(a,t/c));let r=c-t;for(;r>e;)if(r-=e,n){const t=s.lerp(a,(c-r)/c);t.equalsOrClose(i)||(o.push(t),i=t)}u=r}else u+=c}const s=t[t.length-1];!r&&i.equalsOrClose(s)||o.push(s)}return o},e.removeDuplicates=r,e.rdpReduce=function(t,e){if(null==t)throw new Error("pts");if((t=r(t)).length<3)return[...t];const o=[];o.push(0),o.push(t.length-1),n(t,e,0,t.length-1,o),o.sort();const i=[];return o.forEach((e=>i.push(t[e]))),i},e.rdpRecursive=n,e.perpendicularDistance=o},80:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Vector=void 0;class r{constructor(t,e){this.x=t,this.y=e}static from(t){return new r(t.x,t.y)}add(t){return new r(this.x+(t instanceof r?t.x:t),this.y+(t instanceof r?t.y:t))}subtract(t){return new r(this.x-(t instanceof r?t.x:t),this.y-(t instanceof r?t.y:t))}multiply(t){return new r(this.x*(t instanceof r?t.x:t),this.y*(t instanceof r?t.y:t))}divide(t){return new r(this.x/(t instanceof r?t.x:t),this.y/(t instanceof r?t.y:t))}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){const e=this.x-t.x,r=this.y-t.y;return e*e+r*r}lerp(t,e){return new r(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)}equalsOrClose(t){return this.distanceSquared(t)<Number.EPSILON}dot(t){return this.x*t.x+this.y*t.y}lengthSquared(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){return this.divide(this.length())}}e.Vector=r},655:function(t,e,r){r.r(e),r.d(e,{__extends:function(){return o},__assign:function(){return i},__rest:function(){return u},__decorate:function(){return s},__param:function(){return a},__metadata:function(){return c},__awaiter:function(){return l},__generator:function(){return f},__createBinding:function(){return p},__exportStar:function(){return h},__values:function(){return d},__read:function(){return y},__spread:function(){return m},__spreadArrays:function(){return _},__await:function(){return b},__asyncGenerator:function(){return v},__asyncDelegator:function(){return g},__asyncValues:function(){return x},__makeTemplateObject:function(){return w},__importStar:function(){return O},__importDefault:function(){return S},__classPrivateFieldGet:function(){return P},__classPrivateFieldSet:function(){return E}});var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function o(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var i=function(){return(i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function u(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function s(t,e,r,n){var o,i=arguments.length,u=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(u=(i<3?o(u):i>3?o(e,r,u):o(e,r))||u);return i>3&&u&&Object.defineProperty(e,r,u),u}function a(t,e){return function(r,n){e(r,n,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,r,n){return new(r||(r=Promise))((function(o,i){function u(t){try{a(n.next(t))}catch(t){i(t)}}function s(t){try{a(n.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(u,s)}a((n=n.apply(t,e||[])).next())}))}function f(t,e){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function p(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}function h(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||(e[r]=t[r])}function d(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)u.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return u}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(y(arguments[e]));return t}function _(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],u=0,s=i.length;u<s;u++,o++)n[o]=i[u];return n}function b(t){return this instanceof b?(this.v=t,this):new b(t)}function v(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),i=[];return n={},u("next"),u("throw"),u("return"),n[Symbol.asyncIterator]=function(){return this},n;function u(t){o[t]&&(n[t]=function(e){return new Promise((function(r,n){i.push([t,e,r,n])>1||s(t,e)}))})}function s(t,e){try{(r=o[t](e)).value instanceof b?Promise.resolve(r.value.v).then(a,c):l(i[0][2],r)}catch(t){l(i[0][3],t)}var r}function a(t){s("next",t)}function c(t){s("throw",t)}function l(t,e){t(e),i.shift(),i.length&&s(i[0][0],i[0][1])}}function g(t){var e,r;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:b(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function x(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=d(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){!function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)}(n,o,(e=t[r](e)).done,e.value)}))}}}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function O(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function S(t){return t&&t.__esModule?t:{default:t}}function P(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function E(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}return r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(541)}()}));